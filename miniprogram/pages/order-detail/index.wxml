<view class="container">
  <!-- 订单状态 -->
  <view class="order-status-section">
    <view class="status-header">
      <view class="status-icon status-{{order.status}}">
        <image class="status-image" src="/images/status-{{order.status}}.png" mode="aspectFit"></image>
      </view>
      <view class="status-info">
        <view class="status-title">{{order.statusText}}</view>
        <view class="status-desc">{{order.statusDesc}}</view>
      </view>
    </view>
  </view>

  <!-- 服务信息 -->
  <view class="service-info card">
    <view class="section-title">服务信息</view>
    <view class="service-content">
      <image class="service-image" src="{{order.service.images[0] || '/images/default-service.png'}}" mode="aspectFill"></image>
      <view class="service-details">
        <view class="service-title">{{order.service.title}}</view>
        <view class="service-desc">{{order.service.description}}</view>
        <view class="service-price">
          <text class="price-symbol">¥</text>
          <text class="price-value">{{order.price}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 用户信息 -->
  <view class="user-info card">
    <view class="section-title">用户信息</view>
    <view class="user-content">
      <view class="user-item">
        <view class="user-label">发布者</view>
        <view class="user-detail">
          <image class="user-avatar" src="{{order.publisher.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          <view class="user-info-text">
            <view class="user-name">{{order.publisher.nickName}}</view>
            <view class="user-meta">
              <text class="credit-score">信用评分：{{order.publisher.creditScore || 100}}</text>
              <text class="member-level">{{order.publisher.memberLevel || '普通用户'}}</text>
            </view>
          </view>
        </view>
      </view>
      <view class="user-item" wx:if="{{order.receiver}}">
        <view class="user-label">接单者</view>
        <view class="user-detail">
          <image class="user-avatar" src="{{order.receiver.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          <view class="user-info-text">
            <view class="user-name">{{order.receiver.nickName}}</view>
            <view class="user-meta">
              <text class="credit-score">信用评分：{{order.receiver.creditScore || 100}}</text>
              <text class="member-level">{{order.receiver.memberLevel || '普通用户'}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 订单信息 -->
  <view class="order-info card">
    <view class="section-title">订单信息</view>
    <view class="info-list">
      <view class="info-item">
        <text class="info-label">订单号</text>
        <text class="info-value">{{order._id}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">创建时间</text>
        <text class="info-value">{{order.createTimeText}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">服务地址</text>
        <text class="info-value">{{order.location.address || '附近'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">联系方式</text>
        <text class="info-value">{{order.contactInfo.phone || order.contactInfo.wechat || '暂无'}}</text>
      </view>
    </view>
  </view>

  <!-- 订单时间线 -->
  <view class="timeline-section card">
    <view class="section-title">订单进度</view>
    <view class="timeline">
      <view class="timeline-item {{item.active ? 'active' : ''}}" wx:for="{{timeline}}" wx:key="status">
        <view class="timeline-icon">
          <view class="timeline-dot {{item.active ? 'active' : ''}}"></view>
        </view>
        <view class="timeline-content">
          <view class="timeline-title">{{item.title}}</view>
          <view class="timeline-desc">{{item.desc}}</view>
          <view class="timeline-time">{{item.time}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button class="btn btn-outline" bindtap="contactUser">联系用户</button>
    <button class="btn btn-primary" wx:if="{{order.status === '待接单'}}" bindtap="acceptOrder">接单</button>
    <button class="btn btn-secondary" wx:if="{{order.status === '进行中'}}" bindtap="completeOrder">完成订单</button>
    <button class="btn btn-warning" wx:if="{{order.status === '待接单' || order.status === '进行中'}}" bindtap="cancelOrder">取消订单</button>
    <button class="btn btn-success" wx:if="{{order.status === '已完成'}}" bindtap="reviewOrder">评价订单</button>
  </view>

  <!-- 加载状态 -->
  <loading show="{{loading}}" text="加载中..."></loading>
</view> 