# 需求文档

## 介绍

当用户发布服务时，需先经过管理员审核通过后，服务才可在列表对外展示与被下单。

## 需求

### 需求 1 - 发布提交进入待审核

**用户故事：** 作为发布者，我希望在提交服务后进入待审核状态，提示“已提交，待审核”，等待管理员审核。

#### 验收标准（EARS）
1. When 用户提交发布, the 系统 shall 创建服务记录并设置状态为“待审核”。
2. When 创建成功, the 前端 shall 显示“已提交，待审核”提示并返回上一页或“我的服务”。
3. While 状态为“待审核”, the 服务 shall 不出现在对外列表中。

### 需求 2 - 管理员审核通过/拒绝

**用户故事：** 作为管理员，我需要查看待审核服务，并可“通过”或“拒绝（填写原因）”。

#### 验收标准（EARS）
1. When 管理员打开审核列表, the 系统 shall 仅展示状态为“待审核”的服务，按创建时间倒序分页展示。
2. When 管理员选择“通过”, the 系统 shall 将服务状态更新为“发布中”，记录审核人与审核时间。
3. When 管理员选择“拒绝”, the 系统 shall 将服务状态更新为“审核拒绝”，记录拒绝原因、审核人、审核时间。

### 需求 3 - 列表与详情可见性

**用户故事：** 作为普通用户，我只应看到已通过的服务；作为发布者，我可以看到自己所有状态的服务。

#### 验收标准（EARS）
1. While 未指定状态筛选, when 请求服务列表, the 系统 shall 仅返回状态为“发布中”的服务。
2. While 用户为发布者, when 查看“我的服务”, the 系统 shall 返回其所有状态（含待审核、审核拒绝、发布中）。
3. While 服务状态非“发布中”, when 非发布者或非管理员访问服务详情, the 系统 shall 返回“服务未上架或已被拒绝”的提示。

### 需求 4 - 反馈与可观察性

**用户故事：** 作为发布者，我希望在被拒绝时知道原因；作为平台方，希望后续可溯源。

#### 验收标准（EARS）
1. When 服务被拒绝, the 发布者端 shall 在“我的服务”看到状态“审核拒绝”及拒绝原因。
2. When 审核操作发生, the 系统 shall 记录审核人（管理员 openid）、审核时间（ISO 时间）、审核动作与原因（可空）。

## 非功能性
- 安全：审核接口仅限管理员可调用（`users.role === 'admin'`）。
- 兼容：保持现有“发布中”作为对外可见状态，避免影响已实现的列表默认筛选。
- 可拓展：后续可接入订阅消息推送、风控校验。 